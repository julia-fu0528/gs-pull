[workspace]
name = "gspull"
version = "0.1.0"
description = "GS-Pull environment configuration"
channels = ["conda-forge", "pytorch"]
platforms = ["linux-64"]

[dependencies]
python = "3.10.*"
numpy = ">=1.23.0,<1.27.0"
cudatoolkit = "11.7.*"
cudatoolkit-dev = "11.7.*"
cython = "*"
zarr = "*"

[pypi-dependencies]
ninja = "*"
torch = "==1.13.0"
torchvision = "==0.14.0"
pip = "*"
plyfile = "*"
tqdm = "*"
trimesh = "*"

[activation]
env = { PYTHONNOUSERSITE = "1" }

[tasks]
install = """
    python -m pip install -r requirements.txt && \
    python -m pip install pytorch3d
"""

install_splat = """
    unset PYTHONPATH && \
    export TORCH_CUDA_ARCH_LIST="7.5;8.0;8.6" && \
    export FORCE_CUDA=1 && \
    cd gaussian_splatting/submodules/diff-gaussian-rasterization && \
    python -m pip install . --no-build-isolation && \
    cd ../simple-knn && \
    python -m pip install . --no-build-isolation
"""

install_neuralpull = """
    export FORCE_CUDA=1 && \
    python -m pip install -e ./np_utils/extensions/chamfer_dist --no-build-isolation
"""

install_udf = """
    unset PYTHONPATH && \
    cd custom_mc && \
    python setup.py build_ext --inplace
"""